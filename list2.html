<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My List 2</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .entry {
      margin-bottom: 15px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
      position: relative;
      direction: rtl;
    }
    .edit-btn, .save-btn, .cancel-btn {
      margin-left: 10px;
      font-size: 0.8em;
      cursor: pointer;
      padding: 2px 6px;
      border: none;
      border-radius: 3px;
    }
    .edit-btn {
      background-color: #007bff;
      color: white;
    }
    .save-btn {
      background-color: #28a745;
      color: white;
    }
    .cancel-btn {
      background-color: #dc3545;
      color: white;
    }
    .field-label {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>قائمة العب</h1>
    <div id="entries"></div>
    <button id="addButton" onclick="window.location.href='add2.html'">اضافة</button>
    <br /><br />
    <button onclick="window.location.href='home.html'">رجوع</button>
  </div>
  <script>
    const accessMode = localStorage.getItem('accessMode') || 'view';

    // Hide Add button if not in edit mode
    if (accessMode === 'view') {
      document.getElementById('addButton').style.display = 'none';
    }

    const listContainer = document.getElementById('entries');
    let items = JSON.parse(localStorage.getItem('myList2')) || [];

    // The options for your select (adjust as needed)
    const options = ['ساعة', 'ساعتين', 'ثلاث ساعات', 'اربع ساعات'];

    function renderList() {
      listContainer.innerHTML = '';

      items.forEach((item, index) => {
        const div = document.createElement('div');
        div.className = 'entry';

        div.innerHTML = `
          <p>
            <span class="field-label">كم وقت لعبت :</span>
            <span id="display-select1-${index}">${item.select1}</span>
            <select id="edit-select-select1-${index}" style="display:none;">
              ${options.map(opt => `<option value="${opt}" ${opt === item.select1 ? 'selected' : ''}>${opt}</option>`).join('')}
            </select>
            <button class="edit-btn" id="edit-btn-select1-${index}">تعديل</button>
            <button class="save-btn" id="save-btn-select1-${index}" style="display:none;">حفظ</button>
            <button class="cancel-btn" id="cancel-btn-select1-${index}" style="display:none;">إلغاء</button>
          </p>
          <small>${item.day}, ${item.time}</small>
        `;

        listContainer.appendChild(div);

        // Show/hide edit buttons based on accessMode
        const editBtn = document.getElementById(`edit-btn-select1-${index}`);
        const saveBtn = document.getElementById(`save-btn-select1-${index}`);
        const cancelBtn = document.getElementById(`cancel-btn-select1-${index}`);
        const displaySpan = document.getElementById(`display-select1-${index}`);
        const editSelect = document.getElementById(`edit-select-select1-${index}`);

        if (accessMode === 'view') {
          editBtn.style.display = 'none';
        } else {
          // Add button listeners for edit flow
          editBtn.onclick = () => {
            displaySpan.style.display = 'none';
            editSelect.style.display = 'inline-block';
            editBtn.style.display = 'none';
            saveBtn.style.display = 'inline-block';
            cancelBtn.style.display = 'inline-block';
          };
          saveBtn.onclick = () => {
            const newValue = editSelect.value;
            items[index].select1 = newValue;
            localStorage.setItem('myList2', JSON.stringify(items));
            renderList();
          };
          cancelBtn.onclick = () => {
            renderList();
          };
        }
      });
    }

    renderList();
  </script>
</body>
</html>

<!-- 
<button onclick="resetList()">Reset List</button>

<script>
  function resetList() {
    localStorage.removeItem('myList2'); // or use .clear() to wipe all
    alert("List has been reset.");
    location.reload(); // refresh the page to update the display
  }
</script>

-->